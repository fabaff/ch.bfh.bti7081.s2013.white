package ch.bfh.ti.soed.white.mhc_pms.ui;

import java.text.DateFormat;

import ch.bfh.ti.soed.white.mhc_pms.data.MhcPmsDataAccess;
import ch.bfh.ti.soed.white.mhc_pms.data.MhcPmsItem;
import ch.bfh.ti.soed.white.mhc_pms.data.Patient;

import com.vaadin.addon.jpacontainer.EntityItem;
import com.vaadin.annotations.AutoGenerated;
import com.vaadin.shared.ui.label.ContentMode;
import com.vaadin.ui.AbsoluteLayout;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.Label;

class TitleBarComponent extends CustomComponent {

	/*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

	@AutoGenerated
	private AbsoluteLayout mainLayout;
	@AutoGenerated
	private Label lblKindOfTreatment;
	@AutoGenerated
	private Label lblStatus;
	@AutoGenerated
	private Label lblGender;
	@AutoGenerated
	private Label lblDateOfBirth;
	@AutoGenerated
	private Label lblLastName;
	@AutoGenerated
	private Label lblPatientTitle;
	@AutoGenerated
	private Label lblFirstName;
	private static final long serialVersionUID = 1148948780923578333L;

	/**
	 * The constructor should first build the main layout, set the composition
	 * root and then do any custom initialization.
	 * 
	 * The constructor will not be automatically regenerated by the visual
	 * editor.
	 */
	public TitleBarComponent() {
		buildMainLayout();
		setCompositionRoot(mainLayout);

		// TODO Theme verwenden
		this.lblPatientTitle.setContentMode(ContentMode.HTML);
		this.lblPatientTitle.setValue("<h3><b>Patient: </b></h3>");
//		this.lblFirstName.setContentMode(ContentMode.HTML);
//		this.lblFirstName.setCaption("<b>Vorname: </b>");
//		this.lblLastName.setContentMode(ContentMode.HTML);
//		this.lblLastName.setCaption("<b>Nachname: </b>");
//		this.lblDateOfBirth.setContentMode(ContentMode.HTML);
//		this.lblDateOfBirth.setCaption("<b>Geburtsdatum: </b>");
//		this.lblGender.setContentMode(ContentMode.HTML);
//		this.lblGender.setCaption("<b>Geschlecht: </b>");
//		this.lblStatus.setContentMode(ContentMode.HTML);
//		this.lblStatus.setCaption("<b>Status: </b>");
//		this.lblKindOfTreatment.setContentMode(ContentMode.HTML);
//		this.lblKindOfTreatment.setCaption("<b>Behandlungsart: </b>");
		
		this.updateComponentDataSource();
	}

	protected void updateComponentDataSource() {
		// TODO Item Interface implementieren
		
		EntityItem<? extends MhcPmsItem> itemP = MhcPmsDataAccess.getInstance().getCurrentContainer(Patient.class).getCurrentItem();
		if (itemP != null) {
			Patient pat = (Patient) itemP.getEntity();
			this.lblFirstName.setValue(pat.getFirstName());
			this.lblLastName.setValue(pat.getLastName());
			this.lblDateOfBirth.setValue(pat.getDateOfBirth() != null ? DateFormat.getDateInstance(
					DateFormat.MEDIUM).format(pat.getDateOfBirth()) : null);
			this.lblGender.setValue(pat.getGender());
			this.lblStatus.setValue(pat.getStatus());
			this.lblKindOfTreatment.setValue(pat.getKindOfTreatment());
		}
		
//		EntityItem<? extends MhcPmsItem> itemC = MhcPmsDataAccess.getInstance().getCurrentContainer(PCase.class).getCurrentItem();
//		if (itemC != null) {
//			PCase caseP = (PCase) itemP.getEntity();
//			
//		}
		
	}

	@AutoGenerated
	private AbsoluteLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new AbsoluteLayout();
		mainLayout.setImmediate(false);
		mainLayout.setWidth("100%");
		mainLayout.setHeight("100%");
		
		// top-level component properties
		setWidth("100.0%");
		setHeight("100.0%");
		
		// lblFirstName
		lblFirstName = new Label();
		lblFirstName.setCaption("Vorname:");
		lblFirstName.setImmediate(false);
		lblFirstName.setWidth("-1px");
		lblFirstName.setHeight("-1px");
		lblFirstName.setValue("XYZ");
		mainLayout.addComponent(lblFirstName, "top:42.0px;left:120.0px;");
		
		// lblPatientTitle
		lblPatientTitle = new Label();
		lblPatientTitle.setImmediate(false);
		lblPatientTitle.setWidth("-1px");
		lblPatientTitle.setHeight("-1px");
		lblPatientTitle.setValue("Patient: ");
		mainLayout.addComponent(lblPatientTitle, "top:20.0px;left:20.0px;");
		
		// lblLastName
		lblLastName = new Label();
		lblLastName.setCaption("Nachname:");
		lblLastName.setImmediate(false);
		lblLastName.setWidth("-1px");
		lblLastName.setHeight("-1px");
		lblLastName.setValue("XYZ");
		mainLayout.addComponent(lblLastName, "top:100.0px;left:120.0px;");
		
		// lblDateOfBirth
		lblDateOfBirth = new Label();
		lblDateOfBirth.setCaption("Geburtsdatum:");
		lblDateOfBirth.setImmediate(false);
		lblDateOfBirth.setWidth("-1px");
		lblDateOfBirth.setHeight("18px");
		lblDateOfBirth.setValue("XYZ");
		mainLayout.addComponent(lblDateOfBirth, "top:40.0px;left:360.0px;");
		
		// lblGender
		lblGender = new Label();
		lblGender.setCaption("Geschlecht:");
		lblGender.setImmediate(false);
		lblGender.setWidth("-1px");
		lblGender.setHeight("-1px");
		lblGender.setValue("XYZ");
		mainLayout.addComponent(lblGender, "top:100.0px;left:360.0px;");
		
		// lblStatus
		lblStatus = new Label();
		lblStatus.setCaption("Status:");
		lblStatus.setImmediate(false);
		lblStatus.setWidth("-1px");
		lblStatus.setHeight("-1px");
		lblStatus.setValue("XYZ");
		mainLayout.addComponent(lblStatus, "top:40.0px;left:500.0px;");
		
		// lblKindOfTreatment
		lblKindOfTreatment = new Label();
		lblKindOfTreatment.setCaption("Behandlungsart:");
		lblKindOfTreatment.setImmediate(false);
		lblKindOfTreatment.setWidth("-1px");
		lblKindOfTreatment.setHeight("-1px");
		lblKindOfTreatment.setValue("XYZ");
		mainLayout
				.addComponent(lblKindOfTreatment, "top:100.0px;left:500.0px;");
		
		return mainLayout;
	}

}
